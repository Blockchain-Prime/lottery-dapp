import{r as t,L as x,a as r,j as e,p as c,C as S,A as E,o as M,M as W,d as L,H as q,F as d,v as A,B as y}from"./index-72c0ec7f.js";import"./MrdAmount-ce3543c6.js";const F=()=>{const{currentUserInfo:n}=t.useContext(x),[i,s]=t.useState(0);return t.useEffect(()=>{s(n?n[0].length:0)},[n]),r("div",{className:"user-ticket",children:["You have ",r("strong",{children:[i,"x"]}),e("img",{className:"user-ticket__ticket-icon",width:30,src:"../img/lottery-ticket.svg",alt:"Ticket"}),i===1?"ticket":"tickets"," this round."]})};const B=({isWalletConnected:n,isRnsLoading:i,isLoading:s,signerHasRnsDomain:a})=>e("div",{className:"wallet-connect",children:n&&!i&&!s&&!a?r("span",{children:["To use any this dApp you need to own and have a ",e("strong",{children:".reef"})," domain assigned to your mainnet wallet."]}):r("span",{children:["Please connect your wallet on ",e("strong",{children:"mainnet"})," to see your tickets."]})});B.propTypes={isWalletConnected:c.bool.isRequired,isRnsLoading:c.bool.isRequired,signerHasRnsDomain:c.bool.isRequired,isLoading:c.bool.isRequired};const I=({isOpen:n,onClose:i})=>{const{lotteryContract:s}=t.useContext(S),a=t.useContext(E),l={win:{status:"You won!",color:"#e1c9ff",headline:"Lucky you, landlubber!",text:"Check your ticket history for all the exciting details. It'll show which of your numbers matched the winning ones. Enjoy your prize!",prize:1},lose:{status:"Soooorry!",color:"#FFB800",headline:"You did not win anything.",text:"Even Plankton gets lucky sometimes, and he's not the nicest person. Keep your spirits up!",prize:0}},[o,u]=t.useState(""),[w,h]=t.useState(""),[m,g]=t.useState("");t.useEffect(()=>{n&&(async()=>(await A(s,a.selectedReefSigner.evmAddress,f,p)).showWinningScreen?u("win"):u("lose"))()},[n]),t.useEffect(()=>{o==="win"&&n?(M.dropConfetti(),g("bounce")):g("sadFadeIn")},[o,n]),t.useEffect(()=>{h(o==="win"?"green":o==="lose"?"red":"loading")},[o]);const[v,f]=t.useState(!1),[C,p]=t.useState("");return e("div",{children:e(W,{modifier:w,isOpen:n,isContentReady:!!o,onClose:i,children:o?r(L,{animationStyle:m,children:[e(q,{title:l[o].status,color:l[o].color}),e("h3",{children:l[o].headline}),e("p",{className:"muted",children:l[o].text}),e("div",{className:"winner-loser-modal__prize-wrapper ",children:l[o].prize>0?e(d,{children:e("div",{className:"winner-loser-modal_gif-wrapper",children:e("img",{className:"winner-loser-modal__gif",src:"../img/spongebob-celebrating-01.gif",width:"300",alt:"Winner Picture"})})}):e("div",{className:"winner-loser-modal_gif-wrapper",children:e("img",{className:"winner-loser-modal__gif",src:"../img/spongebob-crying-03.gif",width:"300",alt:"Loser Picture"})})})]}):r("div",{children:[e("div",{className:"winner-loser-modal_gif-wrapper",children:e("img",{src:"../img/spongebob-nervous.gif",width:"480",height:"358",alt:"Loader",border:"0"})}),e("h1",{children:"Smart contracts loading..."}),e("h4",{children:C})]})})})};I.propTypes={isOpen:c.bool.isRequired,onClose:c.func.isRequired};const j=({signerHasTickets:n,signerHasRnsDomain:i,appState:s,onClickBuyTicketButton:a})=>{const[l,o]=t.useState(!1),{currentUserInfo:u,currentLotteryId:w,currentLotteryDetails:h}=t.useContext(x),m=!!(s.loading&&!s.error),[g,v]=t.useState(!1),[f,C]=t.useState(!1),p=[];u&&u[1].forEach(k=>p.push({number:k%1e6}));const N=()=>{a()},b=()=>{v(!g)},R=()=>{window.location.href="https://rns.mrdapps.com/"},_=()=>{o(!l)};return t.useEffect(()=>{if(h){const k=Math.floor(Date.now()/1e3);parseInt(h.endTime)-k>0&&C(!0)}},[h]),r(d,{children:[r(L,{title:"Your Tickets",color:"#FFBBE4",footer:e(d,{children:s.isWalletConnected&&!i&&!m&&!s.isRnsLoading?e(y,{className:"btn--primary btn--full",onClick:R,children:"Buy .reef username"}):e(d,{children:s.isWalletConnected&&!s.isRnsLoading&&i&&!m&&r(d,{children:[e(y,{className:"btn--light-green btn--full",icon:"ticket",disabled:!i||!f,onClick:N,children:"Buy Tickets"}),r(y,{className:"btn--secondary btn--full",disabled:!i&&!n||!p.legnth,onClick:b,children:["View ",f?" ":"Last Round"," Tickets"]}),e(y,{className:"btn--primary btn--full",disabled:!i&&!n,onClick:_,children:"Check Win/Loss"})]})})}),children:[s&&i?e(d,{children:f?e(F,{}):"The lottery is currently closed. Please wait for the next lottery round."}):e(B,{isWalletConnected:s.isWalletConnected,signerHasRnsDomain:i,isRnsLoading:s.isRnsLoading,isLoading:m}),e(I,{isOpen:l,onClose:_})]}),e(W,{isOpen:g,onClose:b,children:r(L,{children:[r("h2",{children:["Tickets for round ",w.toString()]}),e("p",{className:"muted",children:"These are the ticket numbers you choosed."}),e("ul",{className:"user-rounds__ticket-list",children:p.map((k,T)=>r("li",{className:"user-rounds__ticket",children:[e("span",{className:"user-rounds__ticket-index",children:`#${T+1}`}),e("div",{className:"user-rounds__ticket-digits-wrapper",children:e("div",{className:"user-rounds__ticket-digits",children:k.number.toString().split("").reverse().join("")})})]},T))})]})})]})};j.propTypes={signerHasTickets:c.bool,signerHasRnsDomain:c.bool.isRequired,appState:c.any,onClickBuyTicketButton:c.func.isRequired};export{j as default};
